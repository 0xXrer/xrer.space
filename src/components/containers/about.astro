---
import Container from "@/components/container.astro";
import Skills from "@/components/Skills.astro";
import portfolioConfig from "@/config/portfolio";

const { personal, skills } = portfolioConfig;

// Extract GitHub username from GitHub URL and construct avatar URL
const getGitHubAvatar = (githubUrl: string | undefined): string => {
    if (!githubUrl) return personal.avatar;

    const match = githubUrl.match(/github\.com\/([^\/]+)/);
    if (match && match[1]) {
        return `https://github.com/${match[1]}.png`;
    }

    return personal.avatar;
};

const avatarUrl = personal.socialLinks.github
    ? getGitHubAvatar(personal.socialLinks.github)
    : personal.avatar;
---

<Container
    showTopBoxes={false}
    showTopLine={false}
    class="h-auto flex flex-col gap-6"
>
    <section class="flex flex-col sm:flex-row items-start gap-6 p-6">
        <!-- Avatar Image -->
        <div
            class="flex-shrink-0 p-0.5 bg-background border border-2 rounded-lg"
        >
            <img
                src={avatarUrl}
                alt={`${personal.name} Profile Picture`}
                class="pointer-events-none select-none w-18 h-18 rounded-lg object-cover outline outline-dashed outline-2 outline-offset-[-1px] outline-border"
            />
        </div>

        <!-- Profile Info -->
        <div class="flex flex-col">
            <h1 class="text-2xl font-bold mb-1">{personal.name}</h1>

            <div class="space-y-2">
                {
                    personal.bio.map((paragraph) => (
                        <p class="text-foreground leading-relaxed">
                            {paragraph}
                        </p>
                    ))
                }

                <Skills skills={skills} />
            </div>
        </div>
    </section>
</Container>
